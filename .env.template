# ──────────────────────────────────────────────────────────────────────────────
# SharePoint Q&A Agent — Environment Configuration
# ──────────────────────────────────────────────────────────────────────────────
# Copy this file to .env and fill in your values:
#   cp .env.template .env
#
# See README-AGENT.md for full documentation on each variable.
# ──────────────────────────────────────────────────────────────────────────────

# ── Azure OpenAI ─────────────────────────────────────────────────────────────
AZURE_OPENAI_ENDPOINT=https://<your-openai-resource>.openai.azure.com
AZURE_OPENAI_DEPLOYMENT=gpt-4o
# AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-3-small
# AZURE_OPENAI_API_VERSION=2024-06-01

# Recommended for local dev (avoids slow DefaultAzureCredential probing).
# In Azure Container Apps, leave empty — managed identity handles auth.
AZURE_OPENAI_API_KEY=

# ── Azure AI Search ──────────────────────────────────────────────────────────
AZURE_SEARCH_ENDPOINT=https://<your-search-service>.search.windows.net

# Search approach: indexer | foundryiq | indexed_sharepoint
SEARCH_APPROACH=indexer

# Required for Approach 1 (indexer)
AZURE_SEARCH_INDEX_NAME=sharepoint-docs-index

# Required for Approaches 2 & 3 (foundryiq / indexed_sharepoint)
# AZURE_SEARCH_API_KEY=
# AZURE_SEARCH_API_VERSION=2025-11-01-preview
# KNOWLEDGE_BASE_NAME=
# KNOWLEDGE_SOURCE_NAME=

# ── Azure Cosmos DB ──────────────────────────────────────────────────────────
COSMOS_ENDPOINT=https://<your-cosmos-account>.documents.azure.com:443
# COSMOS_DATABASE=sharepoint-agent
# COSMOS_CONTAINER=conversations

# ── Microsoft Entra ID ───────────────────────────────────────────────────────
ENTRA_TENANT_ID=<your-tenant-id>
ENTRA_CLIENT_ID=<your-app-client-id>
# ENTRA_CLIENT_SECRET=            # Only needed for OBO flow (Approach 2: foundryiq)

# ── Application ──────────────────────────────────────────────────────────────
# LOG_LEVEL=INFO
# MAX_INPUT_LENGTH=4000
# RATE_LIMIT_PER_MINUTE=20
